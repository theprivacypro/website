---
import { Icon } from 'astro-icon/components';
//import { SITE } from 'astrowind:config';
//import { getHomePermalink } from '~/utils/permalinks';

interface Link {
  text?: string;
  href?: string;
  ariaLabel?: string;
  icon?: string;
}

interface Links {
  title?: string;
  links: Array<Link>;
}

export interface Props {
  links: Array<Links>;
  secondaryLinks: Array<Link>;
  socialLinks: Array<Link>;
  footNote?: string;
  theme?: string;
}

const { socialLinks = [], secondaryLinks = [], links = [], footNote = '', theme = 'light' } = Astro.props;
---


<footer class:list={[
  { dark: theme === 'dark' }, 
  'relative border-t border-gray-200 dark:border-slate-800 not-prose',
  'w-full max-w-7xl mx-auto px-3 md:px-6'
]}>
  <div class="dark:bg-dark absolute inset-0 pointer-events-none" aria-hidden="true"></div>


  <!-- Top row: Three equal-width columns -->
  <div class="relative w-full max-w-5xl mx-auto px-3 md:px-6 dark:text-slate-300 py-8 md:py-12 grid grid-cols-3">

    <!--Links from navigation.ts (SERVICES, ABOUT)-->

    <div class="col-span-2 grid grid-cols-2 md:grid-cols-2 gap-8 w-full">
      {
        links.map(({ title, links }) => (
          <div>
            <div class="dark:text-gray-300 font-medium mb-2">{title}</div>
            {links && Array.isArray(links) && links.length > 0 && (
              <ul class="text-sm">
                {links.map(({ text, href, ariaLabel }) => (
                  <li class="mb-2">
                    <a
                      class="text-muted hover:text-gray-700 hover:underline dark:text-gray-400 transition duration-150 ease-in-out"
                      href={href}
                      aria-label={ariaLabel}
                    >
                      <Fragment set:html={text} />
                    </a>
                  </li>
                ))}
              </ul>
            )}
          </div>
        ))
      }
    </div>


    <!--Subscribe form from Campaign Monitor -->

    <div class="col-span-1 gap-8 w-full">

          <div class="w-full max-w-xs">
            <h4 class="text-base font-medium mb-2 dark:text-gray-300">SUBSCRIBE</h4>
            <form
              action="https://www.createsend.com/t/subscribeerror?description=" 
              method="post"
              class="space-y-2 js-cm-form"
              id="subForm"
              data-id="191722FC90141D02184CB1B62AB3DC267C451A6113320FB9A30E190E3291F249E2A2E70E6DF1310F50939F19E91180CF0480430FB853C8B59B1C0E61C9E64F1C"
            >
              <input
                autocomplete="Email"
                id="fieldEmail"
                type="email"
                name="cm-julrurd-julrurd" 
                placeholder="Your email"
                required=""
                maxlength="200"
                class="js-cm-email-input qa-input-email w-full px-3 py-2 text-sm border border-gray-300 rounded-md dark:bg-gray-800 dark:border-gray-600 dark:text-white"
              />
              <button
                type="submit"
                class="btn btn-primary"
              >
                Subscribe
              </button>
            </form>
          </div>

      <script type="text/javascript" src="https://js.createsend1.com/javascript/copypastesubscribeformlogic.js"></script>

    </div>
</div>



  <!-- Bottom row: Secondary links, footnote, social -->
  <div class="relative w-full max-w-5xl mx-auto px-3 md:px-6 py-6 md:py-8 md:grid md:grid-cols-12 md:items-center gap-4 text-sm text-muted dark:text-gray-400">
    
    <!-- Left: Secondary links -->
    <div class="flex justify-center md:justify-start flex-wrap gap-x-2 gap-y-1 col-span-3">
      {
        secondaryLinks.map(({ text, href }, index) => (
          <>
            {index !== 0 ? <span>Â·</span> : null}
            <a
              class="hover:text-gray-700 hover:underline transition duration-150 ease-in-out"
              href={href}
              set:html={text}
            />
          </>
        ))
      }
    </div>

    <!-- Center: Footnote -->
    <div class="flex justify-center text-center col-span-6">
      <Fragment set:html={footNote} />
    </div>

    <!-- Right: Social icons -->
    <div class="flex justify-center md:justify-end col-span-3">
      {
        socialLinks?.length ? (
          <ul class="flex gap-2">
            {socialLinks.map(({ ariaLabel, href, text, icon }) => (
              <li>
                <a
                  class="hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg p-2 inline-flex items-center"
                  aria-label={ariaLabel}
                  href={href}
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  {icon && <Icon name={icon} class="w-5 h-5" />}
                  <Fragment set:html={text} />
                </a>
              </li>
            ))}
          </ul>
        ) : null
      }
    </div>

  </div>

</footer>